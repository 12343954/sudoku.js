!function(r,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof module&&module.exports?module.exports=n():r.sudoku=n()}("undefined"!=typeof self?self:this,(function(){var r={DIGITS:"123456789"},n="ABCDEFGHI",a=r.DIGITS,e=null,i=null,t=null,f=null,u={easy:62,medium:53,hard:44,"very-hard":35,insane:26,inhuman:17};return r.BLANK_CHAR=".",r.BLANK_BOARD=".................................................................................",r.generate=function(n,a){"string"!=typeof n&&void 0!==n||(n=u[n]||u.easy),n=r._force_range(n,82,17),a=a||!0;for(var i="",t=0;t<81;++t)i+=".";var f=r._get_candidates_map(i),o=r._shuffle(e);for(var _ in o){var s=o[_],v=r._rand_range(f[s].length),l=f[s][v];if(!r._assign(f,s,l))break;var d=[];for(var _ in e){1==f[s=e[_]].length&&d.push(f[s])}if(d.length>=n&&r._strip_dups(d).length>=8){var h="",g=[];for(var t in e){1==f[s=e[t]].length?(h+=f[s],g.push(t)):h+=r.BLANK_CHAR}var c=g.length;if(c>n){g=r._shuffle(g);for(t=0;t<c-n;++t){var p=parseInt(g[t]);h=h.substr(0,p)+r.BLANK_CHAR+h.substr(p+1)}}if(r.solve(h))return h}}return r.generate(n)},r.solve=function(n,a){var e=r.validate_board(n);if(!0!==e)throw e;var i=0;for(var t in n)n[t]!==r.BLANK_CHAR&&r._in(n[t],r.DIGITS)&&++i;if(i<17)throw"Too few givens. Minimum givens is 17";a=a||!1;var f=r._get_candidates_map(n),u=r._search(f,a);if(u){var o="";for(var _ in u)o+=u[_];return o}return!1},r.get_candidates=function(n){var a=r.validate_board(n);if(!0!==a)throw a;var e=r._get_candidates_map(n);if(!e)return!1;var i=[],t=[],f=0;for(var u in e){var o=e[u];t.push(o),f%9==8&&(i.push(t),t=[]),++f}return i},r._get_candidates_map=function(n){var a=r.validate_board(n);if(!0!==a)throw a;var i={},t=r._get_square_vals_map(n);for(var f in e)i[e[f]]=r.DIGITS;for(var u in t){var o=t[u];if(r._in(o,r.DIGITS))if(!r._assign(i,u,o))return!1}return i},r._search=function(n,a){if(!n)return!1;a=a||!1;var i=0;for(var t in e){(_=n[o=e[t]].length)>i&&(i=_,o)}if(1===i)return n;var f=10,u=null;for(t in e){var o,_;(_=n[o=e[t]].length)<f&&_>1&&(f=_,u=o)}var s=n[u];if(a)for(v=s.length-1;v>=0;--v){d=s[v],h=JSON.parse(JSON.stringify(n));if(l=r._search(r._assign(h,u,d),a))return l}else for(var v in s){var l,d=s[v],h=JSON.parse(JSON.stringify(n));if(l=r._search(r._assign(h,u,d)))return l}return!1},r._assign=function(n,a,e){var i=n[a].replace(e,"");for(var t in i){var f=i[t];if(!r._eliminate(n,a,f))return!1}return n},r._eliminate=function(n,a,e){if(!r._in(e,n[a]))return n;n[a]=n[a].replace(e,"");var i=n[a].length;if(1===i){var u=n[a];for(var o in f[a]){var _=f[a][o];if(!r._eliminate(n,_,u))return!1}}if(0===i)return!1;for(var s in t[a]){var v=t[a][s],l=[];for(var d in v){var h=v[d];r._in(e,n[h])&&l.push(h)}if(0===l.length)return!1;if(1===l.length&&!r._assign(n,l[0],e))return!1}return n},r._get_square_vals_map=function(r){var n={};if(r.length!=e.length)throw"Board/squares length mismatch.";for(var a in e)n[e[a]]=r[a];return n},r._get_square_units_map=function(r,n){var a={};for(var e in r){var i=r[e],t=[];for(var f in n){var u=n[f];-1!==u.indexOf(i)&&t.push(u)}a[i]=t}return a},r._get_square_peers_map=function(r,n){var a={};for(var e in r){var i=r[e],t=n[i],f=[];for(var u in t){var o=t[u];for(var _ in o){var s=o[_];-1===f.indexOf(s)&&s!==i&&f.push(s)}}a[i]=f}return a},r._get_all_units=function(n,a){var e=[];for(var i in n)e.push(r._cross(n[i],a));for(var t in a)e.push(r._cross(n,a[t]));var f=["ABC","DEF","GHI"],u=["123","456","789"];for(var o in f)for(var _ in u)e.push(r._cross(f[o],u[_]));return e},r.board_string_to_grid=function(r){var n=[],a=[];for(var e in r)a.push(r[e]),e%9==8&&(n.push(a),a=[]);return n},r.board_grid_to_string=function(r){for(var n="",a=0;a<9;++a)for(var e=0;e<9;++e)n+=r[a][e];return n},r.print_board=function(n){var a=r.validate_board(n);if(!0!==a)throw a;for(var e in n){n[e]+" ",e%3==2&&"  ",e%9==8&&"\n",e%27==26&&"\n"}},r.validate_board=function(n){if(!n)return"Empty board";if(81!==n.length)return"Invalid board size. Board must be exactly 81 squares.";for(var a in n)if(!r._in(n[a],r.DIGITS)&&n[a]!==r.BLANK_CHAR)return"Invalid board character encountered at index "+a+": "+n[a];return!0},r._cross=function(r,n){var a=[];for(var e in r)for(var i in n)a.push(r[e]+n[i]);return a},r._in=function(r,n){return-1!==n.indexOf(r)},r._first_true=function(r){for(var n in r)if(r[n])return r[n];return!1},r._shuffle=function(n){for(var a=[],e=0;e<n.length;++e)a.push(!1);for(var e in n){for(var i=r._rand_range(n.length);a[i];)i=i+1>n.length-1?0:i+1;a[i]=n[e]}return a},r._rand_range=function(r,n){if(n=n||0,r)return Math.floor(Math.random()*(r-n))+n;throw"Range undefined"},r._strip_dups=function(r){var n=[],a={};for(var e in r){var i=r[e];a[i]||(n.push(i),a[i]=!0)}return n},r._force_range=function(r,n,a){return(r=r||0)<(a=a||0)?a:r>n?n:r},e=r._cross(n,a),i=r._get_all_units(n,a),t=r._get_square_units_map(e,i),f=r._get_square_peers_map(e,t),r}));